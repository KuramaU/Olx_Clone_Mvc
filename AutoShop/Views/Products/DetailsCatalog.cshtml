

@model Shop.ViewModels.ProductViewModel;

@{
    ViewData["Title"] = "Перегляд оголошення";
}
<style>


    /* Добавляем стили для изменения цвета иконки при наведении */
    /* Убираем рамку при наведении на иконку сердечка */
    .wish-icon-container .wish-icon:hover,
    .wish-icon-container .wish-icon:focus {
        border-color: transparent !important;
        box-shadow: none !important;
        outline: none !important;
    }

    /* Убираем рамку у кнопки сердечка */
    .btn.wish-icon:focus,
    .btn.wish-icon:active,
    .btn.wish-icon:hover {
        box-shadow: none !important;
        border-color: transparent !important;
        background-color: transparent !important;
    }

    .wish-icon-container .wish-icon:hover {
        color: orange; /* Изменяем цвет на оранжевый при наведении */
    }

    /* Стили для изменения цвета иконки по умолчанию */
    .wish-icon-container .wish-icon {
        color: white; /* Устанавливаем белый цвет по умолчанию */
        border: 1px solid black; /* Добавляем черную обводку */
        border-radius: 50%; /* Делаем обводку круглой */
        padding: 3px; /* Увеличиваем немного размер кнопки */
    }

        .wish-icon-container .wish-icon:hover {
            color: orange; /* Изменяем цвет на оранжевый при наведении */
        }

    /* Стили для изменения цвета иконки по умолчанию */
    .wish-icon-container .wish-icon {
        color: white; /* Устанавливаем белый цвет по умолчанию */
        position: relative; /* Позиционируем иконку относительно родительского элемента */
    }

        /* Псевдоэлементы для создания обводки */
        .wish-icon-container .wish-icon::before,
        .wish-icon-container .wish-icon::after {
            content: ''; /* Добавляем содержимое */
            position: absolute; /* Позиционируем псевдоэлементы абсолютно */
            border-radius: 50%; /* Делаем форму круглой */
            width: 100%; /* Задаем ширину 100% */
            height: 100%; /* Задаем высоту 100% */
            border: 2px solid black; /* Добавляем черную обводку */
            top: 0; /* Располагаем вверху */
            left: 0; /* Располагаем слева */
        }

        /* Псевдоэлемент для левой половины сердца */
        .wish-icon-container .wish-icon::before {
            transform: rotate(-45deg); /* Поворачиваем на -45 градусов */
        }

        /* Псевдоэлемент для правой половины сердца */
        .wish-icon-container .wish-icon::after {
            transform: rotate(45deg); /* Поворачиваем на 45 градусов */
        }

    .wish-icon-container {
        margin-right: -5px;
    }

</style>
<style>
    body {
        background-color: whitesmoke; /* Светлый фон для всего сайта */
        
    }

    .delivery-method {
        padding-left: 3mm; /* Відступ з лівого краю таблиці */
        padding-right: 3mm; /* Відступ з правого краю таблиці */
    }

    .delivery-image {
        max-width: calc(100% - 3mm); /* Розраховуємо ширину з урахуванням відступів */
        height: auto;
        display: block;
        margin: 5px auto; /* Відступи від країв фотографій усередині блоку доставки */
    }


    .card-header{
        background-color: white;
    }

    #carouselExampleControls {
        margin-top: 20px;
        max-width: 800px; /* Максимальная ширина блока с изображениями */
        width: 100%; /* Занимает доступное пространство по ширине */
        margin: 0 auto; /* Центрирование блока по горизонтали */
    }

        #carouselExampleControls .carousel-inner {
            border-radius: 8px;
            overflow: hidden;
        }

        #carouselExampleControls img {
            width: 100%; /* Занимает доступное пространство по ширине внутри блока карусели */
            height: 100%; /* Занимает доступное пространство по высоте внутри блока карусели */
            border-top-left-radius: 8px;
            border-top-right-radius: 8px;
        }

   

    .user-avatar img {
        max-width: 90px;
        height: 90px;
        border-radius: 50%;
    }

    

    .col-4 {
        display: flex; /* Встановлюємо flex контейнер */
        justify-content: space-between; /* Рівномірно розподіляємо елементи по контейнеру */
    /* Відступ від нижнього краю контейнера */
    }

    .md-5 {
        white-space: nowrap; /* Забороняємо перенесення тексту на новий рядок */
        margin-right: 16cm; /* Встановлюємо відступ між елементами */
  
     
    }

    .pos{
        color: orange;
    }

    .carousel-inner {
        border: 2px solid gray; /* Чорна границя товщиною 2px */
        border-radius: 5px; /* Округлені кути */
    }


    .carousel-control-prev-icon {
        background-image: url("data:image/svg+xml;charset=utf8,%3Csvg xmlns='http://www.w3.org/2000/svg' fill='%23000' viewBox='0 0 8 8'%3E%3Cpath d='M5.25 0l-4 4 4 4 1.5-1.5-2.5-2.5 2.5-2.5-1.5-1.5z'/%3E%3C/svg%3E") !important;
    }

    .carousel-control-next-icon {
        background-image: url("data:image/svg+xml;charset=utf8,%3Csvg xmlns='http://www.w3.org/2000/svg' fill='%23000' viewBox='0 0 8 8'%3E%3Cpath d='M2.75 0l-1.5 1.5 2.5 2.5-2.5 2.5 1.5 1.5 4-4-4-4z'/%3E%3C/svg%3E") !important;
    }

   
    .carousel-item {
        display: flex;
        justify-content: center; /* Вирівнюємо по горизонталі по центру */
        max-width: 850px;
        max-height: 350px;
        margin-bottom: 4px; /* Доданий зазначений margin-bottom */
    }
    .d-block 
    {
  
      max-width: 850px;
        max-height: 350px;
    }
</style>



<body>

    <div class="search-container" style="background-color:white;">
        <form asp-controller="Home" asp-action="Index" class="form-inline">
            <div class="input-group">
                <input class="form-control" type="search" placeholder="Шукаю" aria-label="Search" name="SearchString">
                <button type="submit" class="btn btn-outline-secondary">
                    <i class="bi bi-search"></i> <!-- Иконка лупы из Bootstrap Icons -->
                </button>
            </div>
        </form>
    </div>
    <!-- Page content-->
    <div class="container mt-5">
        <div class="row">
            <!-- Blog entries-->
            <div class="col-lg-8">
                <!-- Featured blog post-->
                <div id="carouselExampleIndicators" class="carousel slide mb-4" data-bs-ride="carousel">
                    <div class="carousel-inner ">
                        @if (Model.Images != null && Model.Images.Any())
                        {
                            for (int i = 0; i < Model.Images.Count; i++)
                            {
                                <div class="carousel-item @(i == 0 ? "active" : "")">
                                    <img class="d-block mx-auto" src="data:image/jpeg;base64,@(Convert.ToBase64String(Model.Images[i].ImageData))" alt="..." />
                                </div>
                            }
                        }
                        else
                        {
                            <div class="carousel-item active">
                                <img src="~/default.png" class="d-block w-100" alt="...">
                            </div>
                        }
                    </div>
                     <button class="carousel-control-prev" type="button" data-bs-target="#carouselExampleIndicators" data-bs-slide="prev">
                        <span class="carousel-control-prev-icon" aria-hidden="true"></span>
                        <span class="visually-hidden">Previous</span>
                    </button>
                    <button class="carousel-control-next " type="button" data-bs-target="#carouselExampleIndicators" data-bs-slide="next">
                        <span class="carousel-control-next-icon" aria-hidden="true"></span>
                        <span class="visually-hidden">Next</span>
                    </button>
                </div>
                <!-- Опис товару -->
                <div class="card mb-4">
                    <div class="card-body">
                        <div class="small text-muted">
                            @Model.Product.Category.Name
                        </div>
                        <h2 class="card-title">Опис</h2>
                        <p class="card-text">@Model.Product.Description</p>
                        <hr />
                        <div class="row">
                            <div class="col-6">
                                <p class="md-5">ID: @Model.Product.Id</p>
                            </div>
                            <div class="col-6 text-end">
                                <a class="pos">Поскаржитися</a>

                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <!-- Бічні панелі -->
         
                <!-- Інформація про товар -->
              
              <div class="col-lg-4">
                @if(Model.Product.Has_Delivery!=true)
                {
                    <div class="card mb-4">
                        <div class="card-header text-muted"><small>@Model.Product.CreatedDate.Value.ToString("dd.MM.yyyy")</small></div>
                        <div class="card-body">
                            <div class="product-details">
                                <h4>@Model.Product.Name</h4>
                                <h3><strong>@Model.Product.Price грн</strong></h3>
                            </div>
                           
                        </div>
                    </div>
                }
                else if (Model.Product.Has_Delivery == true)
                  {
                <div class="card mb-4">
                    <div class="card-header text-muted"><small>@Model.Product.CreatedDate.Value.ToString("dd.MM.yyyy")</small></div>
                    <div class="card-body">
                        <div class="product-details">
                            <h4>@Model.Product.Name</h4>
                            <h3><strong>@Model.Product.Price грн</strong></h3>
                        </div>
                        <div class="text-center">
                            <form>
                              
                                <button asp-controller="Delivery" asp-route-id="@Model.Product.Id" asp-action="Index" class="buy-btn btn btn-light text-warning text-black border border-warning w-100">Купити з доставкою</button>
                                </form>
                            </div>
                    </div>
                    <!-- Варіанти доставки -->
                    <div class="delivery-options">
                        <div class="delivery-method">
                            <img src="/ukrposzta.jpg" alt="Укрпошта" class="delivery-image">
       
                            <img src="/novaposzta1.jpg" alt="Відділення Нової Пошти" class="delivery-image">
                            <img src="/novaposzta2.jpg" alt="Кур'єрська доставка Нової Пошти" class="delivery-image">
                            <img src="/novaposzta3.jpg" alt="Відділення Нової Пошти" class="delivery-image">
                            <img src="/meest.jpg" alt="Meest" class="delivery-image">
                        </div>
                    </div>
                </div>
                }
                <!-- Інформація про продавця -->
                <div class="card mb-4">
                    <div class="card-header"><small>Продавець</small></div>
                    <div class="card-body">
                        <div class="row">
                            <div class="col-sm-4">
                                <div class="user-avatar">
                                    <img src="~/avatar.png" alt="Avatar" class="img-fluid" />
                                </div>
                            </div>
                            <div class="col-sm-4">
                                <ul class="list-unstyled mb-0">
                                    <li><b>@Model.Product.Username </b></li>
                                    <li class="text-muted">Онлайн 11:28</li>
                                </ul>
                            </div>
                        </div>
                        <div class="text-center">
                            <form>
                                <a asp-controller="Profil" asp-route-id="@Model.Product.User.Id"  asp-action="Author" style="font-size: smaller;"><small><b>Всі оголошення автора→</b></small></a>
                            </form>
                           
                        </div>
                    </div>
                </div>

                <!-- Інформація про місцезнаходження -->
                <div class="card mb-4">
                    <div class="card-header">Місцезнаходження</div>
                    <div class="card-body">
                        <div class="row">
                            <div class="col-sm-5">
                                <ul class="list-unstyled mb-0">
                                    <li><b><i class="bi bi-geo-alt-fill"></i></b></li>
                                    <li>@Model.Product.District.Name область</li>
                                </ul>
                            </div>
                            <div class="col-sm-5 text-end">
                                <div>
                                    <img src="~/image5.png" alt="Avatar" class="img-fluid" />
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Контактна інформація -->
                <div class="card mb-4">
                    <div class="card-header">Зв'язатися з продавцем</div>
                    <div class="card-body text-center">
                        <button class="btn btn-warning text-white mb-2">Написати повідомлення</button><br>
                        <button id="phoneButton" class="btn btn-light text-warning text-black border border-warning">Номер телефону</button>

                    </div>
                </div>
            </div>
        </div>
    </div>

    <div class="text-start">
        <h3 class="display-4">
            <small style="font-size: smaller;"><small><b>Оголошення від продавця</b></small></small>
        </h3>
    </div>

    <div class="row row-cols-1 row-cols-md-3 g-4 mt-5">
        @if (Model.Product != null && Model.Product.User != null)
        {
            var productsForUser = Model.Products.Where(x => x.User != null && x.User.Email == Model.Product.User.Email).Take(4);
            foreach (var p in productsForUser.Where(x => x.IS_Arhive != true))
            {
                if (p.Id != Model.Product.Id)
                {
                    <div class="col">
                        <div class="card h-100 product-card">
                            <div class="wish-icon-container position-absolute top-0 end-0 mt-2 me-2">
                                @if (Model.User != null && Model.User.Fav_Products != null)
                                {
                                    @if (Model.User.Fav_Products.Any(x => x.ProductId == p.Id))
                                    {
                                        <form>
                                            <button asp-controller="CategoriesMenu" asp-action="UnLike" asp-route-id="@p.Id" class=" btn btn-outline-secondary wish-icon " style="border: none;">
                                                <!-- Само сердечко -->

                                                <i class="bi-heart-fill" style="font-size: 1.5em; color:orange; background-color:none;"></i>

                                            </button>
                                        </form>
                                    }
                                    else
                                    {
                                        <form>
                                            <button asp-controller="CategoriesMenu" asp-action="Like" asp-route-id="@p.Id" class="btn btn-outline-secondary wish-icon" style="border: none;">
                                                <!-- Само сердечко -->

                                                <i class="bi-heart-fill   " style="font-size: 1.5em; "></i>

                                            </button>
                                        </form>
                                    }




                                }
                                else
                                {
                                    @if (User.IsInRole("Administrator") || User.IsInRole("User"))
                                    {
                                        <form>
                                            <button asp-controller="CategoriesMenu" asp-action="Like" asp-route-id="@p.Id" class="btn btn-outline-secondary wish-icon" style="border: none;">
                                                <!-- Само сердечко -->

                                                <i class="bi-heart-fill   " style="font-size: 1.5em; "></i>

                                            </button>
                                        </form>
                                    }
                                    else
                                    {
                                        <form>
                                            <button asp-area="Identity" asp-page="/Account/Register" class=" btn btn-outline-secondary wish-icon " style="border: none;">
                                                <!-- Само сердечко -->

                                                <i class="bi-heart-fill   " style="font-size: 1.5em; "></i>

                                            </button>
                                        </form>
                                    }
                                }
                            </div>
                            <a asp-controller="Products" asp-action="DetailsCatalog" asp-route-id="@p.Id" class="btn btn-outline">
                                @if (Model.Images_2.Where(id => id.ProductId == p.Id) != null && Model.Images_2.Where(id => id.ProductId == p.Id).Any())
                                {

                                    <img src="data:image/jpeg;base64,@(Convert.ToBase64String(p.Images.Where(id => id.ProductId == p.Id).First().ImageData))" alt="..." />

                                }
                                else
                                {
                                    <img src="~/default.png" alt="...">
                                }

                                <div class="card-body text-center">
                                    <h5 class="card-title">@p.Name</h5>
                                    @if (p.Discout != null)
                                    {
                                        var a = p.Price * (100 - p.Discout) / 100;
                                        string b = a?.ToString("0.00##");
                                        <p class="card-text">
                                            <span class="badge bg-danger">@b UAH</span>
                                        </p>
                                    }
                                    else
                                    {
                                        <p class="card-text">
                                            <span class="badge bg-primary">@p.Price UAH</span>
                                        </p>
                                    }
                                </div>
                                <div class="card-footer text-center">

                                    <p class="card-text">
                                        <span class="badge bg-info">обл. @p.District?.Name</span>
                                    </p>
                                    <p class="card-text">
                                        @if (p.CreatedDate?.Day == DateTime.Today.Day)
                                        {
                                            <span class="badge bg-white text-dark">Обновлено сьогодні o @p.CreatedDate?.ToString("HH:mm")</span>
                                        }
                                        @if (p.CreatedDate?.Day == DateTime.Today.Day - 1)
                                        {
                                            <span class="badge bg-white text-dark">Обновлено вчора o  @p.CreatedDate?.ToString("HH:mm")</span>
                                        }
                                        @if (p.CreatedDate?.Day != DateTime.Today.Day && p.CreatedDate?.Day != DateTime.Today.Day - 1)
                                        {
                                            <span class="badge bg-white text-dark">Обновлено @p.CreatedDate?.Day.@p.CreatedDate?.Month.@p.CreatedDate?.Year</span>
                                        }
                                    </p>
                                </div>
                            </a>
                        </div>
                    </div>
                }

            }
        }
    </div>

    <div class="text-start">
        <h3 class="display-4">
            <small style="font-size: smaller;"><small><b>Схожі оголошення</b></small></small>
        </h3>

    </div>
    <div class="row row-cols-1 row-cols-md-3 g-4 mt-5">
        @if (Model.Product != null && Model.Product.User != null)
        {
            var productsForUser = Model.Products.Where(x => x.Category != null && x.Category.Id == Model.Product.Category.Id).Take(4);

            foreach (var p in productsForUser.Where(x => x.IS_Arhive != true))
            {
                if (p.Id != Model.Product.Id)
                {
                    <div class="col">
                        <div class="card h-100 product-card">
                            <div class="wish-icon-container position-absolute top-0 end-0 mt-2 me-2">
                                @if (Model.User != null && Model.User.Fav_Products != null)
                                {
                                    @if (Model.User.Fav_Products.Any(x => x.ProductId == p.Id))
                                    {
                                        <form>
                                            <button asp-controller="CategoriesMenu" asp-action="UnLike" asp-route-id="@p.Id" class=" btn btn-outline-secondary wish-icon " style="border: none;">
                                                <!-- Само сердечко -->

                                                <i class="bi-heart-fill" style="font-size: 1.5em; color:orange; background-color:none;"></i>

                                            </button>
                                        </form>
                                    }
                                    else
                                    {
                                        <form>
                                            <button asp-controller="CategoriesMenu" asp-action="Like" asp-route-id="@p.Id" class="btn btn-outline-secondary wish-icon" style="border: none;">
                                                <!-- Само сердечко -->

                                                <i class="bi-heart-fill   " style="font-size: 1.5em; "></i>

                                            </button>
                                        </form>
                                    }




                                }
                                else
                                {
                                    @if (User.IsInRole("Administrator") || User.IsInRole("User"))
                                    {
                                        <form>
                                            <button asp-controller="CategoriesMenu" asp-action="Like" asp-route-id="@p.Id" class="btn btn-outline-secondary wish-icon" style="border: none;">
                                                <!-- Само сердечко -->

                                                <i class="bi-heart-fill   " style="font-size: 1.5em; "></i>

                                            </button>
                                        </form>
                                    }
                                    else
                                    {
                                        <form>
                                            <button asp-area="Identity" asp-page="/Account/Register" class=" btn btn-outline-secondary wish-icon " style="border: none;">
                                                <!-- Само сердечко -->

                                                <i class="bi-heart-fill   " style="font-size: 1.5em; "></i>

                                            </button>
                                        </form>
                                    }
                                }
                            </div>
                            <a asp-controller="Products" asp-action="DetailsCatalog" asp-route-id="@p.Id" class="btn btn-outline">
                                @if (Model.Images_2.Where(id => id.ProductId == p.Id) != null && Model.Images_2.Where(id => id.ProductId == p.Id).Any())
                                {

                                    <img src="data:image/jpeg;base64,@(Convert.ToBase64String(p.Images.Where(id => id.ProductId == p.Id).First().ImageData))" alt="..." />

                                }
                                else
                                {
                                    <img src="~/default.png" alt="...">
                                }

                                <div class="card-body text-center">
                                    <h5 class="card-title">@p.Name</h5>
                                    @if (p.Discout != null)
                                    {
                                        var a = p.Price * (100 - p.Discout) / 100;
                                        string b = a?.ToString("0.00##");
                                        <p class="card-text">
                                            <span class="badge bg-danger">@b UAH</span>
                                        </p>
                                    }
                                    else
                                    {
                                        <p class="card-text">
                                            <span class="badge bg-primary">@p.Price UAH</span>
                                        </p>
                                    }
                                </div>
                                <div class="card-footer text-center">

                                    <p class="card-text">
                                        <span class="badge bg-info">обл. @p.District?.Name</span>
                                    </p>
                                    <p class="card-text">
                                        @if (p.CreatedDate?.Day == DateTime.Today.Day)
                                        {
                                            <span class="badge bg-white text-dark">Обновлено сьогодні o @p.CreatedDate?.ToString("HH:mm")</span>
                                        }
                                        @if (p.CreatedDate?.Day == DateTime.Today.Day - 1)
                                        {
                                            <span class="badge bg-white text-dark">Обновлено вчора o  @p.CreatedDate?.ToString("HH:mm")</span>
                                        }
                                        @if (p.CreatedDate?.Day != DateTime.Today.Day && p.CreatedDate?.Day != DateTime.Today.Day - 1)
                                        {
                                            <span class="badge bg-white text-dark">Обновлено @p.CreatedDate?.Day.@p.CreatedDate?.Month.@p.CreatedDate?.Year</span>
                                        }
                                    </p>
                                </div>
                            </a>
                        </div>
                    </div>
                }

            }
        }
    </div>

    <!-- Bootstrap Bundle with Popper -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap/5.2.3/js/bootstrap.bundle.min.js"></script>

</body>
<div id="complaintTable" class="position-fixed top-50 start-50 translate-middle" style="display: none; ">
    <div class="card" style="background-color:antiquewhite">
        <div class="card-header" style="background-color:antiquewhite">
            <div class="row">
                <div class="col-sm-4">
                    <h5 class="card-title text-lg-start ">Скарга</h5>

                </div>
                <div class="col-sm-8">
                    <h5 class="card-title text-lg-end ">
                        <button type="button" class="btn-close " aria-label="Close" onclick="closeComplaintTable()"></button>
                    </h5>
                </div>
            </div>

        </div>
        <div class="card-body">
            <!-- Форма таблиці жалоби -->
            <div class="mb-3">
                <label for="complaintType" class="form-label">Тип скарги</label>
                <select class="form-select" id="complaintType" onchange="showSubOptions()">
                    <option selected disabled>Виберіть тип скарги</option>
                    <option value="option1">Неправильні відомості про продавця</option>
                    <option value="option2">Проблема з товаром\послугою</option>
                    <option value="option3">Оголошення,що вводить в оману(не шайхрайське)</option>
                    <option value="option3">Шайхрайство</option>
                    <option value="option3">Жорстоке поводження,дискримінація,оголеність</option>

                </select>
            </div>
            <div id="subOptions" style="display: none;">
                <!-- Підопції в залежності від обраного типу скарги -->
                <div class="mb-3">
                    <!-- Додайте сюди ваші підопції (наприклад, кнопки або поля вводу) -->
                </div>
            </div>
            <div class="mb-3">
                <label for="complaintText" class="form-label">Поясніть,із чим винекла проблема</label>
                <textarea class="form-control" id="complaintText" rows="3"></textarea>
            </div>
            <button type="button" class="btn btn-primary">Надіслати скаргу</button>
        </div>
    </div>
</div>
<script>
    document.getElementById('phoneButton').addEventListener('click', function () {
        this.textContent = "+380 @Model.Product.Phonenumber";
    });

    function toggleComplaintTable() {
        var complaintTable = document.getElementById('complaintTable');
        if (complaintTable.style.display === 'none') {
         
                   complaintTable.style.display = 'block';
        } else {
           
            complaintTable.style.display = 'none';
          
        }
    }

    // Додавання події кліку на кнопку "Поскаржитися"
    document.querySelector('.pos').addEventListener('click', function () {
        // Делегуємо функцію переключення висувної таблиці жалоби
        toggleComplaintTable();
    });

    function closeComplaintTable() {
        toggleComplaintTable();
              var complaintType = document.getElementById('complaintType');
        var complaintText = document.getElementById('complaintText');

        // Очищаємо значення в полях форми
        complaintType.value = '';
        complaintText.value = '';

        // При потребі також очищаємо підопції
        var subOptions = document.getElementById('subOptions');
        subOptions.style.display = 'none';
    }

    function showSubOptions() {
        var complaintType = document.getElementById('complaintType').value;
        var subOptions = document.getElementById('subOptions');
        if (complaintType) {
            subOptions.style.display = 'block';
            // Додатковий код для відображення підопцій в залежності від обраного типу скарги
        } else {
            subOptions.style.display = 'none';
        }
    }
</script>



