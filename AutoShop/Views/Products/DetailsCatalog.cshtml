

@model Shop.ViewModels.ProductViewModel;

@{
    ViewData["Title"] = "Перегляд оголошення";
}
<style>
    body {
        background-color: whitesmoke; /* Светлый фон для всего сайта */
        
    }
    .card-header{
        background-color: white;
    }

    #carouselExampleControls {
        margin-top: 20px;
        max-width: 800px; /* Максимальная ширина блока с изображениями */
        width: 100%; /* Занимает доступное пространство по ширине */
        margin: 0 auto; /* Центрирование блока по горизонтали */
    }

        #carouselExampleControls .carousel-inner {
            border-radius: 8px;
            overflow: hidden;
        }

        #carouselExampleControls img {
            width: 100%; /* Занимает доступное пространство по ширине внутри блока карусели */
            height: 100%; /* Занимает доступное пространство по высоте внутри блока карусели */
            border-top-left-radius: 8px;
            border-top-right-radius: 8px;
        }

    .product-info, .user-info {
        padding: 20px;
        border: 1px solid #e1e1e1; /* Светлый бордюр для блоков информации */
        border-radius: 8px;
        margin-top: 20px;
        background-color: #fff; /* Белый фон для блоков информации */
    }

    .user-avatar img {
        max-width: 90px;
        height: 90px;
        border-radius: 50%;
    }

    .btn-olx {
        background-color: #ffdb4d; /* Цвет фона для кнопок OLX */
        color: #333; /* Цвет текста для кнопок OLX */
        border: 1px solid #e1e1e1; /* Светлый бордюр для кнопок OLX */
        border-radius: 8px;
    }

    .location-card {
        border: 1px solid #e1e1e1;
        border-radius: 8px;
        margin-top: 20px;
        background-color: #fff;
    }

    .contact-card {
        border: 1px solid #e1e1e1;
        border-radius: 8px;
        margin-top: 20px;
        background-color: #fff;
    }

    .description-block {
        border: 1px solid #e1e1e1;
        border-radius: 8px;
        margin-top: 20px;
        background-color: #fff;
        padding: 20px;
    }

    .col-4 {
        display: flex; /* Встановлюємо flex контейнер */
        justify-content: space-between; /* Рівномірно розподіляємо елементи по контейнеру */
    /* Відступ від нижнього краю контейнера */
    }

    .md-5 {
        white-space: nowrap; /* Забороняємо перенесення тексту на новий рядок */
        margin-right: 16cm; /* Встановлюємо відступ між елементами */
  
     
    }

    .pos{
        color: orange;
    }

    .carousel-inner {
        border: 2px solid gray; /* Чорна границя товщиною 2px */
        border-radius: 5px; /* Округлені кути */
    }


    .carousel-control-prev-icon {
        background-image: url("data:image/svg+xml;charset=utf8,%3Csvg xmlns='http://www.w3.org/2000/svg' fill='%23000' viewBox='0 0 8 8'%3E%3Cpath d='M5.25 0l-4 4 4 4 1.5-1.5-2.5-2.5 2.5-2.5-1.5-1.5z'/%3E%3C/svg%3E") !important;
    }

    .carousel-control-next-icon {
        background-image: url("data:image/svg+xml;charset=utf8,%3Csvg xmlns='http://www.w3.org/2000/svg' fill='%23000' viewBox='0 0 8 8'%3E%3Cpath d='M2.75 0l-1.5 1.5 2.5 2.5-2.5 2.5 1.5 1.5 4-4-4-4z'/%3E%3C/svg%3E") !important;
    }

   
    .carousel-item {
        display: flex;
        justify-content: center; /* Вирівнюємо по горизонталі по центру */
        max-width: 850px;
        max-height: 350px;
        margin-bottom: 4px; /* Доданий зазначений margin-bottom */
    }
    .d-block 
    {
  
      max-width: 850px;
        max-height: 350px;
    }
</style>

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no" />
    <meta name="description" content="" />
    <meta name="author" content="" />

    <!-- Bootstrap CSS -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/5.2.3/css/bootstrap.min.css" rel="stylesheet">

</head>
<body>

    <div class="search-container">
        <form asp-controller="Home" asp-action="Index" class="form-inline">
            <div class="input-group">
                <input class="form-control" type="search" placeholder="Шукаю" aria-label="Search" name="SearchString">
                <button type="submit" class="btn btn-outline-secondary">
                    <i class="bi bi-search"></i> <!-- Иконка лупы из Bootstrap Icons -->
                </button>
            </div>
        </form>
    </div>
    <!-- Page content-->
    <div class="container mt-5">
        <div class="row">
            <!-- Blog entries-->
            <div class="col-lg-8">
                <!-- Featured blog post-->
                <div id="carouselExampleIndicators" class="carousel slide mb-4" data-bs-ride="carousel">
                    <div class="carousel-inner ">
                        @if (Model.Images !=null && Model.Images.Any())
                        {
                            for (int i = 0; i < Model.Images.Count; i++)
                            {
                                <div class="carousel-item @(i == 0 ? "active" : "")">
                                    <img class="d-block mx-auto" src="data:image/jpeg;base64,@(Convert.ToBase64String(Model.Images[i].ImageData))" alt="..." />
                                </div>
                            }
                        }
                        else
                        {
                            <div class="carousel-item active">
                                <img src="~/default.png" class="d-block w-100" alt="...">
                            </div>
                        }
                    </div>
                    <button class="carousel-control-prev" type="button" data-bs-target="#carouselExampleIndicators" data-bs-slide="prev" >
                        <span class="carousel-control-prev-icon" aria-hidden="true"></span>
                        <span class="visually-hidden">Previous</span>
                    </button>
                    <button class="carousel-control-next " type="button" data-bs-target="#carouselExampleIndicators" data-bs-slide="next" >
                        <span class="carousel-control-next-icon" aria-hidden="true"></span>
                        <span class="visually-hidden">Next</span>
                    </button>
                </div>
                <!-- Опис товару -->
                <div class="card mb-4">
                    <div class="card-body">
                        <div class="small text-muted" >
                            @Model.Product.Category.Name
                        </div>
                        <h2 class="card-title">Опис</h2>
                        <p class="card-text">@Model.Product.Description</p>
                        <hr />
                        <div class="row">
                            <div class="col-6">
                                <p class="md-5">ID: @Model.Product.Id</p>
                            </div>
                            <div class="col-6 text-end">
                                <a class="pos" >Поскаржитися</a>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <!-- Бічні панелі -->
            <div class="col-lg-4">
                <!-- Інформація про товар -->
                <div class="card mb-4">
                    <div class="card-header text-muted"><small>@Model.Product.CreatedDate.Value.ToString("dd.MM.yyyy")</small></div>
                    <div class="card-body">
                        <div class="input-group d-flex justify-content-between align-items-center">
                            <div class="row">
                                <span>@Model.Product.Name</span>
                            </div>
                            <div class="row">
                                <span class="text-end"><strong>@Model.Product.Price грн</strong></span>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Інформація про продавця -->
                <div class="card mb-4">
                    <div class="card-header"><small>Продавець</small></div>
                    <div class="card-body">
                        <div class="row">
                            <div class="col-sm-4">
                                <div class="user-avatar">
                                    <img src="~/avatar.png" alt="Avatar" class="img-fluid" />
                                </div>
                            </div>
                            <div class="col-sm-4">
                                <ul class="list-unstyled mb-0">
                                    <li><b>@Model.Product.Username </b></li>
                                    <li class="text-muted">Онлайн 11:28</li>
                                </ul>
                            </div>
                        </div>
                        <div class="text-center">
                            <a href="#" class="mt-2 text-black">Всі оголошення автора→</a>
                        </div>
                    </div>
                </div>

                <!-- Інформація про місцезнаходження -->
                <div class="card mb-4">
                    <div class="card-header">Місцезнаходження</div>
                    <div class="card-body">
                        <div class="row">
                            <div class="col-sm-5">
                                <ul class="list-unstyled mb-0">
                                    <li><b><i class="bi bi-geo-alt-fill"></i></b></li>
                                    <li>@Model.Product.District.Name область</li>
                                </ul>
                            </div>
                            <div class="col-sm-5 text-end">
                                <div>
                                    <img src="~/image5.png" alt="Avatar" class="img-fluid" />
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Контактна інформація -->
                <div class="card mb-4">
                    <div class="card-header">Зв'язатися з продавцем</div>
                    <div class="card-body text-center">
                        <button class="btn btn-warning text-white mb-2">Написати повідомлення</button><br>
                        <button id="phoneButton" class="btn btn-light text-warning text-black border border-warning">Номер телефону</button>

                    </div>
                </div>
            </div>
        </div>
    </div>

    <div class="text-start">
        <h3 class="display-4">
            <small style="font-size: smaller;"><small><b>Оголошення від продавця</b></small></small>
        </h3>
@* 
        <a asp-controller="Home" asp-action="Sort" asp-route-cate="@Model.Products.Where(x => x.User != null && x.User.Email == Model.Product.User.Email)" class="btn btn-primary button-right">
            Дивитися усе</>
        </a>  *@
    </div>
  
    <div class="row row-cols-1 row-cols-md-3 g-4 mt-5">
  @if (Model.Product != null && Model.Product.User != null)
    {
            var productsForUser = Model.Products.Where(x => x.User != null && x.User.Email == Model.Product.User.Email).Take(4);
            foreach (var p in productsForUser.Where(x => x.IS_Arhive != true))
        {
                if (p.Id != Model.Product.Id)
                {
                    <div class="col">
                        <div class="card h-100 product-card">
                            <a asp-controller="Products" asp-action="DetailsCatalog" asp-route-id="@p.Id" class="btn btn-outline">
                                @if (Model.Images_2.Where(id => id.ProductId == p.Id) != null && Model.Images_2.Where(id => id.ProductId == p.Id).Any())
                                {

                                    <img src="data:image/jpeg;base64,@(Convert.ToBase64String(p.Images.Where(id => id.ProductId == p.Id).First().ImageData))" alt="..." />

                                }
                                else
                                {
                                    <img src="~/default.png" alt="...">
                                }

                                <div class="card-body text-center">
                                    <h5 class="card-title">@p.Name</h5>
                                    @if (p.Discout != null)
                                    {
                                        var a = p.Price * (100 - p.Discout) / 100;
                                        string b = a?.ToString("0.00##");
                                        <p class="card-text">
                                            <span class="badge bg-danger">@b UAH</span>
                                        </p>
                                    }
                                    else
                                    {
                                        <p class="card-text">
                                            <span class="badge bg-primary">@p.Price UAH</span>
                                        </p>
                                    }
                                </div>
                                <div class="card-footer text-center">

                                    <p class="card-text">
                                        <span class="badge bg-info">обл. @p.District?.Name</span>
                                    </p>
                                    <p class="card-text">
                                        @if (p.CreatedDate?.Day == DateTime.Today.Day)
                                        {
                                            <span class="badge bg-white text-dark">Обновлено сьогодні o @p.CreatedDate?.ToString("HH:mm")</span>
                                        }
                                        @if (p.CreatedDate?.Day == DateTime.Today.Day - 1)
                                        {
                                            <span class="badge bg-white text-dark">Обновлено вчора o  @p.CreatedDate?.ToString("HH:mm")</span>
                                        }
                                        @if (p.CreatedDate?.Day != DateTime.Today.Day && p.CreatedDate?.Day != DateTime.Today.Day - 1)
                                        {
                                            <span class="badge bg-white text-dark">Обновлено @p.CreatedDate?.Day.@p.CreatedDate?.Month.@p.CreatedDate?.Year</span>
                                        }
                                    </p>
                        </div>
                    </a>
                </div>
            </div>
            }
            
        }
    }
    </div>



    <div class="text-start">
        <h3 class="display-4">
            <small style="font-size: smaller;"><small><b>Схожі оголошення</b></small></small>
        </h3>
    
    </div>
    <div class="row row-cols-1 row-cols-md-3 g-4 mt-5">
        @if (Model.Product != null && Model.Product.User != null)
        {
            var productsForUser = Model.Products.Where(x => x.Category != null && x.Category.Id == Model.Product.Category.Id).Take(4);

            foreach (var p in productsForUser.Where(x => x.IS_Arhive != true))
            {
                if (p.Id != Model.Product.Id)
                {
                    <div class="col">
                        <div class="card h-100 product-card">
                            <a asp-controller="Products" asp-action="DetailsCatalog" asp-route-id="@p.Id" class="btn btn-outline">
                                @if (Model.Images_2.Where(id => id.ProductId == p.Id) != null && Model.Images_2.Where(id => id.ProductId == p.Id).Any())
                                {

                                    <img src="data:image/jpeg;base64,@(Convert.ToBase64String(p.Images.Where(id => id.ProductId == p.Id).First().ImageData))" alt="..." />

                                }
                                else
                                {
                                    <img src="~/default.png" alt="...">
                                }

                                <div class="card-body text-center">
                                    <h5 class="card-title">@p.Name</h5>
                                    @if (p.Discout != null)
                                    {
                                        var a = p.Price * (100 - p.Discout) / 100;
                                        string b = a?.ToString("0.00##");
                                        <p class="card-text">
                                            <span class="badge bg-danger">@b UAH</span>
                                        </p>
                                    }
                                    else
                                    {
                                        <p class="card-text">
                                            <span class="badge bg-primary">@p.Price UAH</span>
                                        </p>
                                    }
                                </div>
                                <div class="card-footer text-center">

                                    <p class="card-text">
                                        <span class="badge bg-info">обл. @p.District?.Name</span>
                                    </p>
                                    <p class="card-text">
                                        @if (p.CreatedDate?.Day == DateTime.Today.Day)
                                        {
                                            <span class="badge bg-white text-dark">Обновлено сьогодні o @p.CreatedDate?.ToString("HH:mm")</span>
                                        }
                                        @if (p.CreatedDate?.Day == DateTime.Today.Day - 1)
                                        {
                                            <span class="badge bg-white text-dark">Обновлено вчора o  @p.CreatedDate?.ToString("HH:mm")</span>
                                        }
                                        @if (p.CreatedDate?.Day != DateTime.Today.Day && p.CreatedDate?.Day != DateTime.Today.Day - 1)
                                        {
                                            <span class="badge bg-white text-dark">Обновлено @p.CreatedDate?.Day.@p.CreatedDate?.Month.@p.CreatedDate?.Year</span>
                                        }
                                    </p>
                            </div>
                        </a>
                    </div>
                </div>
                }

            }
        }
    </div>
 
    <!-- Bootstrap Bundle with Popper -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap/5.2.3/js/bootstrap.bundle.min.js"></script>

</body>
</html>
<script>
    document.getElementById('phoneButton').addEventListener('click', function () {
        this.textContent = "+380 @Model.Product.Phonenumber";
    });
</script>

